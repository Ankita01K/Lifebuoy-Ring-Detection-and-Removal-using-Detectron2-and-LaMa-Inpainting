# Lifebuoy Ring Detection and Removal using Detectron2 and LaMa Inpainting

## Project Overview

This project implements a two-step process to detect and remove lifebuoy rings from images. The approach involves:

1. **Lifebuoy Ring Detection:** Using [Detectron2](https://github.com/facebookresearch/detectron2) for object detection and instance segmentation, we trained a custom model to detect lifebuoy rings and generate precise masks.
   
2. **Inpainting:** After generating the masks, [LaMa Inpainting](https://github.com/advimman/lama) is used to remove the detected objects and seamlessly restore the image.

The dataset used for training contains images with lifebuoy rings in diverse conditions, including different environments and backgrounds. Annotations for the rings were created using the [VGG Image Annotator (VIA)](https://www.robots.ox.ac.uk/~vgg/software/via/via_demo.html), a lightweight tool for image labeling.

---

## Table of Contents

- Project Overview
- Dataset Collection and Annotation
- Model Training
  - Detectron2 Training
  - Mask Creation
- LaMa Inpainting
- Results

---

## Dataset Collection and Annotation

### Dataset

The dataset consists of images containing lifebuoy rings in various conditions, such as different lighting, backgrounds, and angles. These diverse conditions ensure that the model can robustly detect lifebuoy rings across a wide range of scenarios.

### Annotation

Annotations were performed using the [VGG Image Annotator (VIA)](https://www.robots.ox.ac.uk/~vgg/software/via/via_demo.html). Polygons were manually drawn around the lifebuoy rings to provide accurate annotations for object detection.

#### Annotation Process:

1. Load the collected images into VIA.
2. Manually draw polygons around the lifebuoy rings to define the regions of interest.
3. Save the annotations in VIAâ€™s JSON format.
4. Place the annotation files in the dataset directory for Detectron2 training.
   
These annotations were essential in training the model to detect and segment the lifebuoy rings.

---

## Model Training

### Detectron2 Training

The annotated dataset was used to fine-tune a pre-trained Mask R-CNN model from [Detectron2](https://github.com/facebookresearch/detectron2), an open-source platform developed by Facebook AI Research for object detection and segmentation tasks.

#### Training Process:

1. **Data Loading:** Load the images and annotations into the Detectron2 framework.
2. **Model:** Fine-tune a pre-trained Mask R-CNN model on the lifebuoy ring dataset.
3. **Hyperparameters:** Customize hyperparameters such as learning rate, batch size, and epochs for optimal performance.
   
Detectron2 was chosen for its powerful instance segmentation capabilities, which helped create high-quality masks of the lifebuoy rings.

### Mask Creation

After training, the Detectron2 model was used to generate masks for the detected lifebuoy rings in the images. These masks formed the basis for the inpainting process, defining the regions to be removed and restored.

---

## LaMa Inpainting

The [LaMa Inpainting](https://github.com/advimman/lama) model was used to remove the detected lifebuoy rings and seamlessly inpaint the masked regions. LaMa is an advanced model specifically designed to handle large masked areas and complex structures, making it ideal for object removal and image restoration tasks.

#### Inpainting Process:

1. **Input:** The original image and the masks generated by Detectron2 were fed into the LaMa inpainting model.
2. **Inpainting:** LaMa filled in the regions defined by the masks, reconstructing the image where the lifebuoy rings were removed.

---

## Results

The following images demonstrate the effectiveness of our lifebuoy ring detection and removal process using Detectron2 and LaMa Inpainting.

### 1. Annotation Example

Here is an example of the annotation process where polygons were drawn around the lifebuoy rings using the [VGG Image Annotator (VIA)](https://www.robots.ox.ac.uk/~vgg/software/via/via_demo.html):

![Annotation Example](https://github.com/user-attachments/assets/e414ddd4-49bd-4f00-8dbd-fe57244ec80a)

---

### 2. Detectron2 Model Prediction

After training the Detectron2 model, we performed inference on a test image. The image below shows how the lifebuoy rings were detected and masked by the model:

![Model Prediction Example](https://github.com/user-attachments/assets/0ed80168-b71f-496b-8c03-2d0250b3ec1d)

---

### 3. Inpainting Results using LaMa

Once the masks were generated by Detectron2, the LaMa Inpainting model was applied to remove the lifebuoy rings and restore the image. The final inpainting result is shown below:

![Inpainting Result](https://github.com/user-attachments/assets/62662bf2-64c9-4eed-b67b-db2161dc2b3a)

---

By integrating Detectron2 for accurate mask generation and LaMa for seamless inpainting, the system effectively removes lifebuoy rings from diverse images.
